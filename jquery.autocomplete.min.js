(function(e){e.fn.autocomplete=function(t){var n=e.extend({containerclass:"jquery-autocomplete-container",searchclass:"jquery-autocomplete-search",resultsclass:"jquery-autocomplete-results",listitemclass:"jquery-autocomplete-listitem",selectedclass:"jquery-autocomplete-selected"},t);var r=n.containerclass;var i=n.searchclass;var s=n.resultsclass;var o=n.listitemclass;var u=n.selectedclass;var a=function(t){var n=e(t).attr("for");e(t).next().empty();var r=e(t).val().toLowerCase();if(r.length>0){var i=[];var u=0;e("#"+n).children().each(function(){if(e(this).text().toLowerCase().match(r)){i[u]={val:e(this).val(),text:e(this).text()};u++}});if(i.length>0){for(var a in i){var l=e("<li/>",{value:i[a].val,"class":o,text:i[a].text});l.click(f);l.appendTo(e("."+s+'[for="'+n+'"]'))}e("."+s+'[for="'+n+'"]').show()}else{e("."+s+'[for="'+n+'"]').hide()}if(e("."+s+'[for="'+n+'"]').children()===0){e("."+s+'[for="'+n+'"]').hide()}}else{e("."+s+'[for="'+n+'"]').hide()}};var f=function(){if(e(this).hasClass(u)){e(this).parent().prev().val(e(this).text());e(this).parent().prev().attr("value",e(this).attr("value"));e(this).parent().hide()}else{e(this).parent().children().removeClass(u);e(this).parent().children().addClass(o);e(this).addClass(u);e(this).removeClass(o)}};var l=function(t,n,r){var i=false;var s=e(t).offset();var o=e(t).width();var u=e(t).height();if(n>=s.left&n<=s.left+o&r>=s.top&r<=s.top+u){i=true}return i};this.each(function(){e(this).hide();var t=e("."+r).length;var n=e("<div/>",{"class":r,width:e(this).attr("width"),margin:e(this).attr("margin")});if(e(this).attr("id")===undefined){e(this).attr("id","jquery-autocomplete"+t)}var f=e(this).attr("id");var c=e("<input/>",{"class":i,"for":f});c.css("padding",n.css("padding"));c.keydown(function(t){var n=e(this).attr("for");if(t.keyCode===38||t.keyCode===40){if(e("."+s+'[for="'+n+'"] .'+u).length===1){var r=e("."+s+'[for="'+n+'"]').children("."+u);r.removeClass(u);r.addClass(o);var i;if(t.keyCode===38){if(r.prev().length>0){i=r.prev()}else{i=r}}if(t.keyCode===40){if(r.next().length>0){i=r.next()}else{i=r}}i.addClass(u);i.removeClass(o);var a=e("."+s+'[for="'+n+'"]');var f=parseInt(i.css("height"),10);var l=a.scrollTop();var c=i.offset().top-e("."+s+'[for="'+n+'"]').children(":first").offset().top;if(c+f>l+parseInt(a.css("height"),10)){a.scrollTop(c+f-parseInt(a.css("height"),10))}if(c<l){a.scrollTop(c)}}else{e("."+s+'[for="'+n+'"]').children(":first").addClass(u);e("."+s+'[for="'+n+'"]').children(":first").removeClass(o)}}else if(t.keyCode===13){if(e("."+s+'[for="'+n+'"] .'+u).length===1){e(this).val(e("."+s+'[for="'+n+'"] .'+u).text());e("."+s+'[for="'+n+'"]').hide()}}});c.keyup(function(e){if(e.keyCode!==13&&e.keyCode!==38&&e.keyCode!==40){a(this)}});c.focus(function(){a(this)});c.appendTo(n);e(this).after(n);var h=e("<ul/>",{"class":s,"for":f});h.css("padding-left",0);h.css("width",parseInt(c.css("width"),10)+parseInt(c.css("padding-left"),10)+parseInt(c.css("padding-right"),10));h.css("left",c.position().left);h.css("margin-top",parseInt(c.css("margin-bottom"),10)*-1);h.css("position","absolute");h.css("margin-left",c.css("margin-left"));h.css("margin-right",c.css("margin-right"));h.children().on("load",function(){e(this).css("color","red")});h.children().on("click",function(){e(this).parent().children().removeClass(u);e(this).parent().children().addClass(o);e(this).addClass(u);e(this).removeClass(o)});h.appendTo(n);e(document).click(function(t){var n=t.clientX;var r=t.clientY;e("."+s+":visible").each(function(){var t=false;if(l(e(this),n,r)){t=true}if(l(e(this).parent(),n,r)){t=true}if(l(e(this).prev(),n,r)){t=true}if(!t){e(this).hide()}})})})}})(jQuery)